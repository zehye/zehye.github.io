---
layout: post
title: ë¨¸ì‹ ëŸ¬ë‹ - ë¹„ì§€ë„í•™ìŠµ(ë´ë“œë¡œê·¸ë¨, K-Means)
category: Machine Learning
tags: [Machine Learning]
comments: true
---

> ê°œì¸ê³µë¶€ í›„ ìë£Œë¥¼ ë‚¨ê¸°ê¸° ìœ„í•œ ëª©ì ì„ìœ¼ë¡œ ë‚´ìš© ìƒì— ì˜¤ë¥˜ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.    

<hr>

## ë¹„ì§€ë„ í•™ìŠµ?

ë³´ìœ í•œ ë°ì´í„°ì— íƒ€ê²Ÿê°’(y)ê°€ ì—†ëŠ” ê²½ìš°

1. ê³„ì¸µì  êµ°ì§‘í™” > ë´ë“œë¡œê·¸ë¨
2. ë¹„ê³„ì¸µì  êµ°ì§‘í™” > K-Means, DBSCAN ë“±ì„ ì‚¬ìš©

ë¹„ì§€ë„ í•™ìŠµì€ ì„œë¹„ìŠ¤ ë‹¨ì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€ëŠ¥ & ì„œë¹„ìŠ¤ë¥¼ ì´í•´í•  ë•Œë§Œ ì‚¬ìš© ê°€ëŠ¥ 
> ë†’ì€ ì •í™•ë„ë¥¼ ê°€ì§€ê¸° í˜ë“¤ê¸° ë•Œë¬¸



### ë´ë“œë¡œê·¸ë¨

ëª¨ë¸ì„ êµ¬ë™ í›„ ì‚¬í›„ì ìœ¼ë¡œ êµ°ì§‘ì„ ë‚˜ëˆŒ ìˆ˜ ìˆìŒ 

<center>
<figure>
<img src="/assets/post-img/ML/15.png" alt="" width="70%">
</figure>
</center>

ìœ„ ê·¸ë¦¼ì—ì„œ ë‚´ê°€ 2000ì„ ê¸°ì¤€ìœ¼ë¡œ êµ°ì§‘ì„ ë‚˜ëˆˆë‹¤ë©´, ìœ„ì—ì„œ êµ°ì§‘ì€ ì´ 4ê°œë¡œ ë‚˜ë‰˜ê²Œ ë¨! 
(2000ì„ ê¸°ì¤€ìœ¼ë¡œ ê°€ë¡œ ì§ì„ ì„ ê·¸ì–´ë³´ë©´ ë¨)


í•˜ì§€ë§Œ ì´ëŠ” ì—°ì‚°ì´ ë§ì•„ì§ˆ ìˆ˜ ìˆê³ , ì´ˆë°˜ì— ì˜ëª» ë¶„ë¥˜ë˜ë©´ ì˜¤ë¶„ë¥˜ì˜ ê°€ëŠ¥ì„±ì´ ìˆë‹¤ëŠ” ë‹¨ì ì´ ì¡´ì¬í•¨.



### K-Means

1. ì´ˆë°˜ì— ì„¼íŠ¸ë¡œì´ë“œ ì„¤ì •ì„ í•´ì£¼ê³ , 
2. ì„¼íŠ¸ë¡œì´ë“œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê±°ë¦¬ë¥¼ ê³„ì‚°í•¨.
3. ì„¼íŠ¸ë¡œì´ë“œê°€ ê±°ë¦¬ë¥¼ ìµœì†Œí™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì´ë™í•¨
4. ë‹¤ì‹œí•œë²ˆ ë‚˜ë¨¸ì§€ ì• ë“¤ë¼ë¦¬ ì´ë™í•˜ê³ 
5. ì„¼íŠ¸ë¡œì´ë“œê°€ ê±°ë¦¬ ê³„ì‚°í•´ì„œ ì´ë™.. ë°˜ë³µ..

- ì„¼íŠ¸ë¡œì´ë“œ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™í•˜ë‹¤ë³´ë‹ˆ, ì—°ì‚°ì´ ë´ë“œë¡œê·¸ë¨ë³´ë‹¤ëŠ” ì ë‹¤.
- ê·¸ëŸ¬ë‚˜ êµ°ì§‘ì´ ëª‡ê°œê°€ ë ì§€ ì•Œìˆ˜ê°€ ì—†ì–´ì„œ, ì´ˆë°˜ ì„¼íŠ¸ë¡œì´ë“œë¥¼ ì„¤ì •í•´ì•¼í•˜ëŠ” ê²ƒì´ ë‹¨ì ì´ë‹¤. 
- ì„¼íŠ¸ë¡œì´ë“œê°€ ì ì • êµ°ì§‘ë³´ë‹¤ í¬ë©´ ì•ˆì¢‹ìœ¼ë‹ˆê¹Œ > ì™œê³¡ëœë‹¤ê³  ë³´ë©´ ëœë‹¤. 

<center>
<figure>
<img src="/assets/post-img/ML/16.png" alt="" width="70%">
</figure>
</center>


### ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°

```python 
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

from sklearn.datasets import load_iris
from sklearn.cluster import KMeans

from sklearn.decomposition import PCA
```


### ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

```python 
iris = load_iris()
X = iris.data
```


### ëª¨ë¸ ì •ì˜

```python 
# n_clusters: ë°ì´í„°ì˜ ì„¼íŠ¸ë¡œì´ë“œë¥¼ ì„¤ì • 
# ì„¼íŠ¸ë¡œì´ë“œ: êµ°ì§‘ì˜ ì¤‘ì‹¬ > ê·¸ ì¤‘ì‹¬ì„ ë‚´ê°€ ì •í•´ì£¼ëŠ” ê²ƒ > ëª‡ê°œì˜ êµ°ì§‘ìœ¼ë¡œ ì„¤ì •í•  ê²ƒì¸ì§€? 
kmeans = KMeans(n_clusters=3, random_state=42)
```


### ëª¨ë¸ í›ˆë ¨

```python 
kmeans.fit(X)
cluster = kmeans.fit_predict(X)
```


### ì‹œê°í™” > ì£¼ì„±ë¶„ ë¶„ì„(PCA)

```python 
labels = kmeans.labels_

pca = PCA(n_components=2)
X_pca = pca.fit_transform(X)

centroids = pca.transform(kmeans.cluster_centers_)

plt.figure(figsize=(10, 7))
plt.scatter(X_pca[:, 0], X_pca[:, 1], c=labels, cmap='viridis', marker='o', edgecolor='k', s=50)
plt.scatter(centroids[:, 0], centroids[:, 1], c='red', marker='X', s=200, label='Centroids')
plt.title('K-Means Clustering on Iris Dataset')
plt.xlabel('PCA Component 1')
plt.ylabel('PCA Component 2')
plt.legend()
plt.show()
```

<center>
<figure>
<img src="/assets/post-img/ML/17.png" alt="" width="70%">
</figure>
</center>


K-Meansì˜ ì•½ì ì€ ì´ˆë°˜ ì„¼íŠ¸ë¡œì´ë“œë¥¼ ì„ íƒí•´ì•¼í•˜ëŠ” ê²ƒì— ìˆëŠ”ë°, ì´ë¥¼ ë³´ì™„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œëŠ” 

1. ì—˜ë³´ìš°
2. ì‹¤ë£¨ì—£ ê³„ìˆ˜
ê°€ ìˆë‹¤. (ì ì • êµ°ì§‘ì„ êµ¬í•˜ëŠ” ë°©ë²•ì„)

- ì—˜ë³´ìš°: forë¬¸ ëŒë©´ì„œ ê±°ë¦¬í•©ì„ êµ¬í•¨, (í´ëŸ¬ìŠ¤í„° ê°¯ìˆ˜ê°€ ì¦ê°€í–ˆì„ë–„ í•©ì´ ìµœì†Œí™” ë˜ëŠ” ë°©í–¥ìœ¼ë¡œ)
    - ê°¯ìˆ˜ë§ˆë‹¤ì˜ ì¦ê° ì°¨ì´ë¥¼ ë´ì•¼í•˜ë©° ì–´ëŠìˆœê°„ ëœ ì¤„ì–´ë“œëŠ” ë•Œë¥¼ ë´ì¤˜ì•¼ í•¨ > ìµœì ì˜ êµ°ì§‘ì„ ì°¾ëŠ”ê²Œ ì¤‘ìš”
    - kê°€ ì¦ê°€í•˜ë©´ SSE(ì—ëŸ¬ì˜ í•©)ì´ ì¤„ì–´ë“œëŠ” ê²ƒì„ ë³´ëŠ” ê²ƒìœ¼ë¡œ ìµœì  këŠ” SSE ê°ì†Œìœ¨ì´ ê¸‰ê²©íˆ ì¤„ì–´ë“œëŠ” íŒ”ê¿ˆì¹˜ ì§€ì ì„ 
    - ì„¼íŠ¸ë¡œì´ë“œì™€ ì ë“¤ì˜ ê±°ë¦¬ë¥¼ ì—ëŸ¬ > ì´ ì—ëŸ¬ì˜ í•©ì„ ì¤„ì´ëŠ”ê²Œ ëª©í‘œ

```python 
# ë‹¤ì–‘í•œ Kê°’ì— ëŒ€í•´ ì„±ëŠ¥ ì¸¡ì •
inertias = []
K_range = range(1, 4)

# forë¬¸ ëŒë©´ì„œ ê±°ë¦¬í•©ì„ êµ¬í•¨ 
for k in K_range:
    kmeans = KMeans(n_clusters=k, random_state=42)
    kmeans.fit(X)
    inertias.append(kmeans.inertia_)

# ì—˜ë³´ìš° ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
plt.figure(figsize=(8, 5))
plt.plot(K_range, inertias, 'bo-')
plt.xlabel('í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ (K)')
plt.ylabel('Inertia (í´ëŸ¬ìŠ¤í„° ë‚´ ê±°ë¦¬ì˜ í•©)')
plt.title('ğŸ“ˆ ìµœì ì˜ K ì°¾ê¸°: Elbow Method')
plt.grid(True, alpha=0.3)
plt.show()

# íŒ”ê¿ˆì¹˜ ë¶€ë¶„ì´ ìµœì ì˜ K!
```

<center>
<figure>
<img src="/assets/post-img/ML/19.png" alt="" width="70%">
</figure>
</center>

1ê°œì˜€ì„ë–„ì˜ ê±°ë¦¬í•©ê³¼ 2ê°œì˜€ì„ë•Œì˜ ê±°ë¦¬í•©ì´ í™•ì—°íˆ ì¤„ì–´ë“œëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.


- ì‹¤ë£¨ì—£: forë¬¸ ëŒë©´ì„œ predict, predictì—ì„œ ì‹¤ë£¨ì—£ í•œ ê²ƒì„ í´ëŸ¬ìŠ¤í„°ì— ì–¼ë§ˆë‚˜ ì˜ ì†í•´ìˆëŠ” ì§€ë¥¼ ì¸¡ì •í•¨
    - í•˜ë‚˜ì˜ êµ°ì§‘ì„ í´ëŸ¬ìŠ¤í„°ë¼ê³  í•˜ëŠ”ë°, ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‚´ ì„¼íŠ¸ë¡œì´ë“œì™€ ë‹¤ë¥¸ ì ë“¤ê³¼ì˜ ê±°ë¦¬ë¥¼ ì¬ê³  ê°€ì¥ ê°€ê¹Œìš´ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„° ê¹Œì§€ì˜ í‰ê· ê±°ë¦¬ë¥¼ ê°€ì§€ê³  ê³„ì‚°ì‹ìœ¼ë¡œ ì‹¤ë£¨ì—£ ê³„ìˆ˜ë¥¼ ì •í•¨
    - ì‹¤ë£¨ì—£ ê³„ìˆ˜ê°€ í¬ë©´ ì ì ˆ(1ì— ê°€ê¹Œìš°ë©´)
    - ìŒìˆ˜ëŠ” ì´ìƒì¹˜ê°€ ë§ì´ ê»´ìˆì„ ê²½ìš°ë¡œ ì˜ëª»ëœ í´ëŸ¬ìŠ¤í„°ì— í• ë‹¹ëœ ê²ƒ
    - 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ í´ëŸ¬ìŠ¤í„° ê²½ê³„ì— ìœ„ì¹˜í•œ ê²ƒ 


```python 
from sklearn.metrics import silhouette_score

# ì‹¤ë£¨ì—£ ì ìˆ˜ ê³„ì‚°
silhouette_scores = []
K_range = range(2, 4)  # ìµœì†Œ 2ê°œ ê·¸ë£¹ í•„ìš”

for k in K_range:
    kmeans = KMeans(n_clusters=k, random_state=42)
    labels = kmeans.fit_predict(X)
    score = silhouette_score(X, labels)
    silhouette_scores.append(score)
    print(f"K={k}: ì‹¤ë£¨ì—£ ì ìˆ˜ = {score:.3f}")

# ê°€ì¥ ë†’ì€ ì ìˆ˜ê°€ ìµœì ì˜ K!
best_k = K_range[np.argmax(silhouette_scores)]
print(f"\nğŸ¯ ìµœì ì˜ K: {best_k}")
```

---

## ì‹¤ìŠµí•´ë³´ê¸°

```python 
data = {
    'ì—°ê°„êµ¬ë§¤ê¸ˆì•¡': [20, 25, 30, 100, 120, 110, 200, 250, 220],
    'ì—°ê°„ë°©ë¬¸íšŸìˆ˜': [5, 8, 6, 20, 25, 22, 40, 45, 38]
}
df = pd.DataFrame(data)
```


### ë°ì´í„° ìŠ¤ì¼€ì¼ë§ 

```python 
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X = scaler.fit_transform(df)
```

### K-Means

```python 
kmeans = KMeans(n_clusters=3, random_state=42)
# kmeans.fit(X)

# cluster_labels = kmeans.labels_
cluster_labels = kmeans.fit_predict(X)
```

### ê²°ê³¼ í™•ì¸

```python 
df['ê³ ê°ê·¸ë£¹'] = cluster_labels
```


### ì‹œê°í™” 

```python 
plt.figure(figsize=(10, 6))
colors = ['red', 'blue', 'green']
for i in range(3):
    mask = cluster_labels == i
    plt.scatter(df[mask]['ì—°ê°„êµ¬ë§¤ê¸ˆì•¡'], df[mask]['ì—°ê°„ë°©ë¬¸íšŸìˆ˜'],
               c=colors[i], label=f'ê·¸ë£¹ {i+1}', s=100)

# ì¤‘ì‹¬ì  í‘œì‹œ
centers_original = scaler.inverse_transform(kmeans.cluster_centers_)
plt.scatter(centers_original[:, 0], centers_original[:, 1],
           c='black', marker='x', s=200, linewidths=3, label='ì¤‘ì‹¬ì ')

plt.xlabel('ì—°ê°„ êµ¬ë§¤ê¸ˆì•¡ (ë§Œì›)')
plt.ylabel('ì—°ê°„ ë°©ë¬¸íšŸìˆ˜')
plt.title(' ê³ ê° ì„¸ë¶„í™” ê²°ê³¼')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
```


<center>
<figure>
<img src="/assets/post-img/ML/18.png" alt="" width="70%">
</figure>
</center>
